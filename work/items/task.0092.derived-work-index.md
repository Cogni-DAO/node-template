---
id: task.0092
type: task
title: "Derive _index.md from frontmatter — stop merge-conflict factory"
status: needs_merge
priority: 0
rank: 1
estimate: 2
summary: Make work/items/_index.md a gitignored generated artifact. Individual .md files are the sole source of truth. Add generator script, next-id scanner, CI duplicate-ID check.
outcome: _index.md is gitignored and generated by pnpm work:index. No more merge conflicts from concurrent work item edits. CI catches duplicate IDs and broken frontmatter.
spec_refs:
  - development-lifecycle
assignees: derekg1729
credit:
project: proj.docs-system-infrastructure
branch: feat/subject-did-foundation
pr:
reviewer:
revision: 0
blocked_by:
deploy_verified: false
created: 2026-02-19
updated: 2026-02-19
labels: [workflow, tooling]
external_refs:
---

# Derive \_index.md from Frontmatter

## Requirements

- `work/items/_index.md` is gitignored and generated by `pnpm work:index`
- `pnpm work:next-id` scans frontmatter to find the next available numeric ID
- CI (`pnpm check:docs`) runs the generator and fails on parse errors or duplicate IDs
- `/idea`, `/bug`, `/task` commands no longer edit `_index.md`
- OpenClaw ideas and development agent SOULs no longer edit `_index.md`
- `work/README.md` documents `INDEX_IS_DERIVED` hard rule

## Allowed Changes

- `scripts/` — generator and next-id scripts
- `.gitignore`, `package.json` — wiring
- `.claude/commands/{idea,bug,task}.md` — remove index edit steps
- `services/sandbox-openclaw/gateway-workspace/` — agent SOUL updates
- `work/README.md` — rule updates

## Plan

- [x] Write `scripts/generate-work-index.mjs` with duplicate ID detection
- [x] Write `scripts/next-work-id.mjs`
- [x] Gitignore `_index.md`, untrack from git
- [x] Add `work:index` and `work:next-id` to `package.json`, wire into `check:docs`
- [x] Update `/idea`, `/bug`, `/task` commands
- [x] Update OpenClaw ideas and development agent SOULs
- [x] Update `work/README.md` with `INDEX_IS_DERIVED` rule

## Validation

**Command:**

```bash
pnpm work:index && pnpm work:next-id && pnpm check:docs
```

**Expected:** Generator emits index, next-id prints 4-digit number, check:docs passes.

**Duplicate ID test:** Copy a work item with the same `id:` field, run `pnpm work:index` — exits non-zero.

## Review Checklist

- [x] **Work Item:** `task.0092` linked in PR body
- [x] **Spec:** INDEX_IS_DERIVED documented in work/README.md
- [ ] **Tests:** generator tested manually (duplicate detection verified)
- [ ] **Reviewer:** assigned and approved

## PR / Links

-

## Attribution

- derekg1729 — implementation
